<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <title>Predict cryptocurrency prices with Tensorflow as binary classification problem &mdash; archive.kauri.io</title>
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/tonsky/FiraCode@1.206/distr/fira_code.css">
    <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.8.1/css/all.css">
    <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.8.1/css/v4-shims.css">
    <link rel="stylesheet" href="../../../css/theme.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
    <link rel="stylesheet" href="../../../css/extra.css">
    <script src="//code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/solidity.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/rust.min.js"></script>
    <script>
        hljs.initHighlightingOnLoad();
    </script> 
</head>

<body ontouchstart="">
    <div id="container">
        <aside>
            <div class="home">
                <div class="title">
                    <button class="hamburger"></button>
                    <a href="../../.." class="site-name"> archive.kauri.io</a>
                </div>
                <div class="search">
                    <div role="search">
    <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
        <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
    </form>
</div>
                </div>
            </div>
            <nav class="nav">
                <ul class="root">
                    <li class="toctree-l1"><a class="nav-item" href="../../..">Home</a></li>
                    <li class="toctree-l1"><button class="section nav-item">Communities</button>
<ul class="subnav">
    <li class="toctree-l2"><button class="section nav-item hide">Getting started with dapp development</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/tips-for-starting-dapp-development/">Tips for Starting Dapp Development</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/an-introduction-to-solidity-for-experienced-devel/">An Introduction to Solidity for Experienced Developers</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/truffle--adding-a-frontend-with-react-box/">Truffle  Adding a frontend with react box</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/truffle--testing-your-smart-contract/">Truffle  Testing your smart contract</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/truffle--smart-contract-compilation-and-deploymen/">Truffle  Smart Contract Compilation & Deployment</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/understanding-smart-contract-compilation-and-depl/">Understanding smart contract compilation and deployment</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/tools-for-dapp-development/">Tools for dApp development</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/full-stack-dapp-tutorial-series-intro/">Full Stack dApp Tutorial Series - Intro</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/erc-721-non-fungible-token-standard/">ERC-721 Non-Fungible Token Standard</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/create-a-%22hello-world%22-fullstack-dapp/">Create a "Hello World" fullstack dapp</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/a-fullstack-dapp-for-creating-tokens/">A fullstack dapp for creating tokens</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/a-fullstack-dapp-for-creating-unique-tradable-tok/">A fullstack dapp for creating unique tradable tokens</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/blockchain-explained/">Blockchain Explained</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/remix-ide-your-first-smart-contract/">Remix IDE - Your first smart contract</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/an-introduction-to-smart-contracts-with-solidity/">An Introduction to Smart Contracts with Solidity</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Java Ethereum</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/how-to-test-ethereum-smart-contracts-from-java/">How to test Ethereum smart contracts from Java</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/web3j-transaction-managers/">Web3j Transaction Managers</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/manage-erc20-tokens-in-java-with-web3j/">Manage ERC20 tokens in Java with Web3j</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/running-a-pantheon-node-in-java-integration-tests/">Running a Pantheon Node in Java Integration Tests</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/managing-storage-in-a-java-application-with-ipfs/">Managing storage in a Java application with IPFS</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/using-besu-the-java-ethereum-client-with-linuxmac/">Using Besu, the Java Ethereum Client with Linux/MacOS</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/listening-for-ethereum-smart-contract-events-in-j/">Listening for Ethereum Smart Contract Events in Java</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/interacting-with-an-ethereum-smart-contract-in-ja/">Interacting with an Ethereum Smart Contract in Java</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/generate-a-java-wrapper-from-your-smart-contract/">Generate a Java Wrapper from your Smart Contract</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/manage-an-ethereum-account-with-java-and-web3j/">Manage an Ethereum account with Java and Web3j</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/connecting-to-an-ethereum-client-with-java-eclips/">Connecting to an Ethereum client with Java, Eclipse and Web3j</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Ethereum Node Runners</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Ethereum%20Node%20Runners/run-an-ethereum-node-on-debian-with-an-external-s/">Run an Ethereum node on Debian with an External SSD (Mar 2020)</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Ethereum%20Node%20Runners/ethereum-on-arm.-turn-your-arm-device-into-a-full/">Ethereum on ARM. Turn your ARM device into a full Ethereum node just by flashing a MicroSD card</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Ethereum%20Node%20Runners/make-use-of-your-remote-ethereum-node-using-an-ss/">Make use of your remote Ethereum node using an SSH tunnel and MetaMask</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Ethereum%20Node%20Runners/how-to-install-and-synchronize-your-own-remote-et/">How to install and synchronize your own remote Ethereum node</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Ethereum%20Node%20Runners/how-to-set-up-a-simple-linux-firewall/">How to set up a simple Linux firewall</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Ethereum%20Node%20Runners/supported-hardware-to-run-an-ethereum-node/">Supported hardware to run an Ethereum node</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Ethereum%20Node%20Runners/monitor-your-geth-node-with-google-sheet/">Monitor your Geth node with Google Sheet</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Ethereum%20Node%20Runners/running-an-ethereum-full-node-on-a-raspberrypi-4-/">Running an Ethereum Full Node on a RaspberryPi 4 (model B)</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">IPFS</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/building-a-twitter-bot-using-ipfs-cluster/">Building a Twitter Bot using IPFS Cluster 🤖</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/hands-on-ipld-tutorial-in-golang--part-2/">Hands-on IPLD Tutorial in Golang  PART 2</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/understanding-ipfs-in-depth%2826%29--what-is-interpla/">Understanding IPFS in Depth(2/6)  What is InterPlanetary Linked Data(IPLD)?</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/hands-on-ipld-tutorial-in-golang/">Hands-on IPLD Tutorial in Golang</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/understanding-ipfs-in-depth%2816%29--a-beginner-to-ad/">Understanding IPFS in Depth(1/6)  A Beginner to Advanced Guide</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/orbitdb--serverless-distributed-peer-to-peer-data/">OrbitDB  Serverless, Distributed, Peer-to-Peer Database</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/getting-started-with-mahuta-a-search-engine-for-t/">Getting started with Mahuta - A Search engine for the IPFS</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/peer-to-peer-hypermedia-with-ipfs/">Peer-to-peer hypermedia with IPFS</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/installing-ipfs/">Installing IPFS</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/improving-ipfs-decentralization-introducing-ahken/">Improving IPFS Decentralization - Introducing Ahken</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/managing-storage-in-a-java-application-with-ipfs/">Managing storage in a Java application with IPFS</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Documentation and technical communication</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Documentation%20and%20technical%20communication/why-do-people-write/">Why do people write?</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Documentation%20and%20technical%20communication/language-and-understandable-writing/">Language and understandable writing</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Documentation%20and%20technical%20communication/documentation-structure/">Documentation structure</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Documentation%20and%20technical%20communication/why-write-documentation/">Why write documentation</a></li>
</ul></li>
</ul></li>
                    <li class="toctree-l1"><button class="section nav-item">Collections</button>
<ul class="subnav">
    <li class="toctree-l2"><button class="section nav-item hide">A Deep Dive Into The Ethereum Virtual Machine (EVM) Series</button>
<ul class="subnav hide">
    <li class="toctree-l3">
<a class="nav-item" href="../../A%20Deep%20Dive%20Into%20The%20Ethereum%20Virtual%20Machine%20%28EVM%29%20Series/a-deep-dive-into-the-ethereum-virtual-machine-%28ev/">A Deep Dive into the Ethereum Virtual Machine (EVM) - part 1  Introduction</a></li>
    <li class="toctree-l3">
<a class="nav-item" href="../../A%20Deep%20Dive%20Into%20The%20Ethereum%20Virtual%20Machine%20%28EVM%29%20Series/a-deep-dive-into-the-ethereum-virtual-machine-%28ev/">A Deep Dive into the Ethereum Virtual Machine (EVM) - part 2  Memory and Storage</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Deep%20Dive%20Into%20The%20Ethereum%20Virtual%20Machine%20%28EVM%29%20Series/a-deep-dive-into-the-ethereum-virtual-machine-%28ev/">A Deep Dive into the Ethereum Virtual Machine (EVM) - Part 3  Execution Model of the EVM</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Deep%20Dive%20Into%20The%20Ethereum%20Virtual%20Machine%20%28EVM%29%20Series/a-deep-dive-into-the-ethereum-virtual-machine-par/">A Deep Dive into the Ethereum Virtual Machine - Part 4  The EVM and High-Level Programming Languages</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Build your very own self-hosting platform with Raspberry Pi and Kubernetes</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Build%20your%20very%20own%20self-hosting%20platform%20with%20Raspberry%20Pi%20and%20Kubernetes/%2818%29-build-your-very-own-self-hosting-platform-wi/">(1/8) Build your very own self-hosting platform with Raspberry Pi and Kubernetes - Introduction</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Build%20your%20very%20own%20self-hosting%20platform%20with%20Raspberry%20Pi%20and%20Kubernetes/%2828%29-install-raspbian-operating-system-and-prepar/">(2/8) Install Raspbian Operating-System and prepare the system for Kubernetes</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Build%20your%20very%20own%20self-hosting%20platform%20with%20Raspberry%20Pi%20and%20Kubernetes/%2838%29-install-and-configure-a-kubernetes-cluster-w/">(3/8) Install and configure a Kubernetes cluster with k3s to self-host applications</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Build%20your%20very%20own%20self-hosting%20platform%20with%20Raspberry%20Pi%20and%20Kubernetes/%2848%29-deploy-nextcloud-on-kuberbetes--the-self-hos/">(4/8) Deploy NextCloud on Kuberbetes  The self-hosted Dropbox</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Build%20your%20very%20own%20self-hosting%20platform%20with%20Raspberry%20Pi%20and%20Kubernetes/%2858%29-self-host-your-media-center-on-kubernetes-wi/">(5/8) Self-host your Media Center On Kubernetes with Plex, Sonarr, Radarr, Transmission and Jackett</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Build%20your%20very%20own%20self-hosting%20platform%20with%20Raspberry%20Pi%20and%20Kubernetes/%2868%29-self-host-pi-hole-on-kubernetes-and-block-ad/">(6/8) Self-host Pi-Hole on Kubernetes and block ads and trackers at the network level</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Build%20your%20very%20own%20self-hosting%20platform%20with%20Raspberry%20Pi%20and%20Kubernetes/%2878%29-self-host-your-password-manager-with-bitward/">(7/8) Self-host your password manager with Bitwarden</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Build%20your%20very%20own%20self-hosting%20platform%20with%20Raspberry%20Pi%20and%20Kubernetes/%2888%29-deploy-prometheus-and-grafana-to-monitor-a-k/">(8/8) Deploy Prometheus and Grafana to monitor a Kubernetes cluster</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">A Hackathon Survival Guide</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/the-hack%21-what-is-a-hackathon/">The Hack?!? What is a hackathon?</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/create-a-%22hello-world%22-fullstack-dapp/">Create a "Hello World" fullstack dapp</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/full-stack-dapp-tutorial-series-intro/">Full Stack dApp Tutorial Series - Intro</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/ethereum-101-part-1-what-is-ethereum/">Ethereum 101 - Part 1 - What is Ethereum?</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/remix-ide-your-first-smart-contract/">Remix IDE - Your first smart contract</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/interacting-with-an-ethereum-smart-contract-in-ja/">Interacting with an Ethereum Smart Contract in Java</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/a-.net-developer-s-workflow-for-creating-and-call/">A .NET Developer’s Workflow for Creating and Calling Ethereum Smart Contracts</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/sending-ethereum-transactions-with-rust/">Sending Ethereum Transactions with Rust</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/generate-a-java-wrapper-from-your-smart-contract/">Generate a Java Wrapper from your Smart Contract</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/accelerating-dapp-development-with-ethers.js/">Accelerating DApp Development with Ethers.js</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/nethereum-an-open-source-.net-integration-library/">Nethereum - An open source .NET integration library for blockchain</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/creating-a-dapp-in-go-with-geth/">Creating a DApp in Go with Geth</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/tools-for-dapp-development/">Tools for dApp development</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/ethasketch/">EthASketch</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/bountibot--rewarding-github-pull-requests-for-you/">Bountibot  rewarding GitHub Pull Requests for you and the rest of the OSS community</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/eth-dev-tools/">ETH Dev Tools</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Web3j Cheat Sheet (Java Ethereum)</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Web3j%20Cheat%20Sheet%20%28Java%20Ethereum%29/retrieving-an-ethereum-account-balance-in-web3j/">Retrieving an Ethereum Account Balance in Web3j</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Web3j%20Cheat%20Sheet%20%28Java%20Ethereum%29/converting-between-ether-units-denominations-in-w/">Converting Between Ether Units / Denominations in Web3j</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Web3j%20Cheat%20Sheet%20%28Java%20Ethereum%29/creating-a-web3j-wallet-from-a-mnemonic-code-%28see/">Creating a Web3j Wallet from a Mnemonic Code (Seed Phrase)</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Web3j%20Cheat%20Sheet%20%28Java%20Ethereum%29/sending-an-ether-transfer-transaction-from-one-ac/">Sending an Ether Transfer Transaction from One Account to Another in Web3j</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Web3j%20Cheat%20Sheet%20%28Java%20Ethereum%29/signing-an-ethereum-transaction-in-web3j/">Signing an Ethereum Transaction in Web3j</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Web3j%20Cheat%20Sheet%20%28Java%20Ethereum%29/signing-data-in-java-and-web3j/">Signing Data in Java and Web3j</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">OpenZeppelin</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../OpenZeppelin/openzeppelin-part-1--introductory/">OpenZeppelin Part 1  Introductory</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../OpenZeppelin/openzeppelin-part-2--access-control/">OpenZeppelin Part 2  Access Control</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../OpenZeppelin/openzeppelin-part-3--token-standards/">OpenZeppelin Part 3  Token Standards</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../OpenZeppelin/openzeppelin-part-4--crowdsales/">OpenZeppelin Part 4  Crowdsales</a></li>
</ul></li>
    <li class="toctree-l2 current"><button class="section nav-item">A non practitioner guide to machine learning</button>
<ul class="subnav">
    <li class="toctree-l3"><a class="nav-item" href="../getting-started-with-machine-learning-%28non-practi/">Getting Started With Machine Learning (Non practitioner guide)</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../installing-anaconda-python3-and-tensorflow/">Installing Anaconda, Python3 and Tensorflow</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../regression-with-python-keras-and-tensorflow/">Regression with Python, Keras and Tensorflow</a></li>
    <li class="toctree-l3 current"><a class="nav-item current" href="./">Predict cryptocurrency prices with Tensorflow as binary classification problem</a>
<ul class="subnav">
<li class="toctree-l4"><a class="nav-item toc" href="#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="nav-item toc" href="#what-well-be-doing">What we'll be doing</a></li>
<li class="toctree-l4"><a class="nav-item toc" href="#downloading-data-using-binance-api">Downloading data using Binance API</a></li>
<li class="toctree-l4"><a class="nav-item toc" href="#preprocessing-the-data">Preprocessing the data</a></li>
<li class="toctree-l4"><a class="nav-item toc" href="#training-the-models">Training the model(s)</a></li>
<li class="toctree-l4"><a class="nav-item toc" href="#feature-engineering">Feature engineering</a></li>
<li class="toctree-l4"><a class="nav-item toc" href="#evaluating-the-best-performing-models">Evaluating the best performing models.</a></li>
</ul></li>
    <li class="toctree-l3"><a class="nav-item" href="../multi-class-classification-example-with-convoluti/">Multi-class classification example with Convolutional Neural Network in Keras and Tensorflow</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">An ethereum test toolkit in Go</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../An%20ethereum%20test%20toolkit%20in%20Go/sending-transactions-on-geth-s-simulated-backend/">Sending Transactions on GETH's Simulated Backend</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../An%20ethereum%20test%20toolkit%20in%20Go/interacting-with-smart-contracts-from-geth-s-simu/">Interacting with smart contracts from GETH's Simulated Backend</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../An%20ethereum%20test%20toolkit%20in%20Go/generating-a-load-of-keys-for-testing-in-go/">Generating a load of keys for testing in Go</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../An%20ethereum%20test%20toolkit%20in%20Go/the-geth-simulated-backend/">The GETH Simulated Backend</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Monitoring Kubernetes with Elastic Stack</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Monitoring%20Kubernetes%20with%20Elastic%20Stack/%2815%29-getting-started-with-elastic-stack-for-monit/">(1/5) Getting started with Elastic Stack for monitoring on Kubernetes</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Monitoring%20Kubernetes%20with%20Elastic%20Stack/%2825%29-install-elasticsearch-and-kibana-to-store-an/">(2/5) Install ElasticSearch and Kibana to store and visualize monitoring data</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Monitoring%20Kubernetes%20with%20Elastic%20Stack/%2835%29-collect-metrics-with-elastic-metricbeat-for-/">(3/5) Collect metrics with Elastic Metricbeat for monitoring Kubernetes</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Monitoring%20Kubernetes%20with%20Elastic%20Stack/%2845%29-collect-logs-with-elastic-filebeat-for-monit/">(4/5) Collect logs with Elastic Filebeat for monitoring Kubernetes</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Monitoring%20Kubernetes%20with%20Elastic%20Stack/%2855%29-collect-traces-with-elastic-apm-for-monitori/">(5/5) Collect traces with Elastic APM for monitoring Kubernetes</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Founder interviews</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Founder%20interviews/fluree--blockchain-graphql-and-more-all-in-one-da/">Fluree  Blockchain, GraphQL, and more all in one database</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Founder%20interviews/true-anonymity-privacy-and-snapps-with-simon-harm/">True anonymity, privacy, and SNApps with Simon Harman of Loki</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Founder%20interviews/the-aeternity-blockchain-with-emil-wagner/">The Æternity blockchain with Emil Wagner</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Founder%20interviews/embleema--the-blockchain-that-lets-you-own-your-h/">Embleema  The Blockchain That Lets You Own Your Health Data</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Vyper Full Stack dApp Tutorial Series</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Vyper%20Full%20Stack%20dApp%20Tutorial%20Series/remix-ide-your-first-vyper-smart-contract/">Remix IDE - Your first Vyper smart contract</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Vyper%20Full%20Stack%20dApp%20Tutorial%20Series/understanding-smart-contract-compilation-and-depl/">Understanding smart contract compilation and deployment</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Vyper%20Full%20Stack%20dApp%20Tutorial%20Series/truffle--smart-contract-compilation-and-deploymen/">Truffle  Smart Contract Compilation & Deployment</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Vyper%20Full%20Stack%20dApp%20Tutorial%20Series/truffle--testing-your-smart-contract/">Truffle  Testing your smart contract</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Vyper%20Full%20Stack%20dApp%20Tutorial%20Series/tools-for-working-with-vyper/">Tools for working with Vyper</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Flexible, Upgradeable & Highly Available NFTs</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Flexible%2C%20Upgradeable%20%26%20Highly%20Available%20NFTs/creating-a-flexible-nft-%28part-1%29/">Creating a Flexible NFT (Part 1)</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Flexible%2C%20Upgradeable%20%26%20Highly%20Available%20NFTs/creating-a-flexible-nft-%28part-2%29/">Creating a Flexible NFT (Part 2)</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Libra</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Libra/building-and-working-with-facebook-s-cryptocurren/">Building and Working with Facebook’s Cryptocurrency Libra</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Libra/whitepaper-deep-dive-move--facebook-libra-blockch/">Whitepaper Deep Dive — Move  Facebook Libra Blockchain’s New Programming Language</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Libra/quick-dive-into-the-move-programming-language/">Quick Dive into the Move Programming Language</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Bitcoin</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Bitcoin/bitcoin-blockchain-overview/">Bitcoin Blockchain Overview</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Bitcoin/creating-bitcoin-transactions/">Creating Bitcoin Transactions</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Bitcoin/bitcoin-contract-scripts/">Bitcoin Contract Scripts</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Bitcoin/lightning-at-home/">Lightning at Home</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Bitcoin/lnd-overview-and-developer-guide/">LND Overview and Developer Guide</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Getting Started</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/blockchain-explained/">Blockchain Explained</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/an-introduction-to-smart-contracts-with-solidity/">An Introduction to Smart Contracts with Solidity</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/an-introduction-to-smart-contracts-with-vyper/">An Introduction to Smart Contracts with Vyper</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/cute-kitties-and-where-to-find-them-an-introducti/">Cute Kitties and Where to Find Them — An Introduction to Non-Fungible Tokens</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/erc-721-non-fungible-token-standard/">ERC-721 Non-Fungible Token Standard</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/erc-20-token-standard/">ERC-20 Token Standard</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/develop-your-erc-20-token-explained%21/">Develop your ERC-20 Token — explained!</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/gamifying-crypto-assets-with-the-erc998-composabl/">Gamifying Crypto Assets with the ERC998 Composables Token Standard</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/erc-20-and-its-discontents--the-rise-of-comrades-/">ERC-20 and Its Discontents  The Rise of Comrades ERC-777 & ERC-1820</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/creating-a-dapp-in-go-with-geth/">Creating a DApp in Go with Geth</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/smart-contracts-integration-with-nethereum/">Smart contracts integration with Nethereum</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/signing-messages-with-nethereum/">Signing messages with Nethereum</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/managing-nonces-with-nethereum/">Managing nonces with Nethereum</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/connecting-to-an-ethereum-client-with-java-eclips/">Connecting to an Ethereum client with Java, Eclipse and Web3j</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Privacy</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/introduction-to-cryptography/">Introduction to Cryptography</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/building-on-bulletproofs-short-proofs-for-confide/">Building on Bulletproofs - Short Proofs for Confidential Transactions</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/enigma-protocol/">Enigma Protocol</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/how-to-code-your-own-confidential-token-on-ethere/">How to Code Your Own Confidential Token on Ethereum</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/data-privacy-with-the-nucypher-network/">Data Privacy with the NuCypher Network</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/nucypher-pyumbral/">NuCypher - PyUmbral</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/nightfall-private-token-and-nft-transfers-on-ethe/">Nightfall - Private Token and NFT Transfers on Ethereum</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/privacy-with-pantheon-ethereum-java-client/">Privacy with Pantheon Ethereum Java Client</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/parity-private-transactions/">Parity - Private Transactions</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/introducing-beam%21/">Introducing Beam!</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/a-short-history-of-mimblewimble--from-hogwarts-to/">A Short History of Mimblewimble  From Hogwarts to Mobile Wallets</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/why-beam-is-sound-money/">Why Beam is Sound Money</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/introduction-to-mimblewimble-and-grin/">Introduction to MimbleWimble and Grin</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/a-beginner-s-guide-to-zcash/">A beginner’s guide to Zcash</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/a-beginner-s-guide-to-monero/">A beginner’s guide to Monero</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Open Finance (DeFi)</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Open%20Finance%20%28DeFi%29/kyber-network--on-chain-liquidity-protocol/">Kyber Network  On-chain liquidity protocol</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Open%20Finance%20%28DeFi%29/compound--money-markets-on-ethereum/">Compound  Money markets on Ethereum</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Open%20Finance%20%28DeFi%29/0x--peer-to-peer-exchange-protocol/">0x  Peer-to-peer exchange protocol</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Open%20Finance%20%28DeFi%29/makerdao--decentralized-stablecoin-and-collateral/">MakerDAO  Decentralized stablecoin and collateral loans</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Open%20Finance%20%28DeFi%29/uniswap--protocol-for-automated-token-exchange/">Uniswap  Protocol for automated token exchange</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Open%20Finance%20%28DeFi%29/set-protocol--baskets-of-tokenized-assets/">Set Protocol  Baskets of tokenized assets</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Open%20Finance%20%28DeFi%29/an-introduction-to-bonding-curves/">An Introduction to Bonding Curves</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Open%20Finance%20%28DeFi%29/incentivizing-high-quality-curation-with-a-token-/">Incentivizing high-quality curation with a Token-Curated Registry</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">DevOps</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../DevOps/lint-your-solidity-contracts-with-solhint/">Lint your Solidity contracts with Solhint</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../DevOps/lint-your-solidity-contracts-with-ethlint/">Lint your Solidity contracts with Ethlint</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../DevOps/truffle--testing-your-smart-contract/">Truffle  Testing your smart contract</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../DevOps/truffle-101-development-tools-for-smart-contracts/">Truffle 101 - Development Tools for Smart Contracts</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../DevOps/analyze-solidity-smart-contracts-with-slither/">Analyze Solidity Smart Contracts with Slither</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">SecureETH</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../SecureETH/system-description-document/">System Description Document</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../SecureETH/secureth-guidelines-getting-started/">SecurEth Guidelines - Getting Started</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../SecureETH/secureth-guidelines-introduction/">SecurEth Guidelines Introduction</a></li>
</ul></li>
</ul></li>
                </ul>
            </nav>
            <div class="repo">
    <div class="previous"><a href="../regression-with-python-keras-and-tensorflow/">&laquo; Previous</a></div>
    <div class="next"><a href="../multi-class-classification-example-with-convoluti/">Next &raquo;</a></div>
</div>
        </aside>
        <div id="spacer"><button class="arrow"></button></div>
        <main>
            <div class="home-top">
                <button class="hamburger"></button>
                <a href="../../.." class="site-name"> archive.kauri.io</a>
            </div>
            <div id="main">
                <nav class="breadcrumbs">
<ul>
    <li>Collections &raquo; </li><li>A non practitioner guide to machine learning</li>
</ul>
</nav>
                <div id="content"><h1 id="predict-cryptocurrency-prices-with-tensorflow-as-binary-classification-problem">Predict cryptocurrency prices with Tensorflow as binary classification problem</h1>
<p><img alt="" src="https://ipfs.infura.io/ipfs/QmevA8kcH7ZfEVeepf72EvvUvmZBfUMZXuWhcC74XLrscB" /></p>
<h3 id="introduction">Introduction</h3>
<p>In this tutorial we'll go through the prototype for a neural network which will allow us to estimate cryptocurrency prices in the future, as a binary classification problem, using Keras and Tensorflow as the  our main clarvoyance tools.</p>
<p>While it is most likely not the best way to approach the problem (after all investment banks invest billions in developing such algorithms), if we can get it right more than 55% of the times, we are in the money!</p>
<h3 id="what-well-be-doing">What we'll be doing</h3>
<ul>
<li>Download data using Binance API</li>
<li>Preprocess the data</li>
<li>Train our model(s)</li>
<li>Feature engineering</li>
<li>Evaluate best performing models</li>
</ul>
<h3 id="downloading-data-using-binance-api">Downloading data using Binance API</h3>
<p>for this example we'll download the maximum amount of data that can be fetched in a single call. If you want to train a better more and use it in the real world (which is not recommended by the way, you will likely loose real money), I would suggest to gather more data using multiple calls.</p>
<pre><code class="language-python">import requests
import json
import pandas as pd
import datetime as dt

START_DATE = '2019-01-01'
END_DATE = '2019-10-01'
INTERVAL = '15m'

def parse_date(x):
    return str(int(dt.datetime.fromisoformat(x).timestamp()))

def get_bars(symbol, interval):
    root_url = 'https://api.binance.com/api/v1/klines'
    url = root_url + '?symbol=' + symbol + '&amp;interval=' + interval + '&amp;startTime=' + parse_date(START_DATE) + '&amp;limit=1000'
    data = json.loads(requests.get(url).text)
    df = pd.DataFrame(data)
    df.columns = ['open_time',
                  'o', 'h', 'l', 'c', 'v',
                  'close_time', 'qav', 'num_trades',
                  'taker_base_vol', 'taker_quote_vol', 'ignore']
    df.drop(['ignore', 'close_time'], axis=1, inplace=True)
    return df

ethusdt = get_bars('ETHUSDT', INTERVAL)
ethusdt.to_csv('./data.csv', index=False)
</code></pre>
<p>In this simple piece of code we are requiring the necessary packages, setup a couple of parameters (I picked a 15 minutes interval but you can pick more granular interval for higher frequency trading) and setup a couple of convenience functions, then save the data to csv for future reuse. This should be self explanatory but if something confuses you, please feel free to leave a comment asking for clarifications :)</p>
<h3 id="preprocessing-the-data">Preprocessing the data</h3>
<p>As prices overtime is a form of sequential data we are going to use a LSTM layer (Long-short-term-memory) as the first layer in our net. We want to provide data as a sequence of events, which will predict the price at time <code>t+n</code> where <code>t</code> is the current time and <code>n</code> defines how far in the future we want to predict, to do so we'll feed data as a time window  of <code>w</code> length. It will all be clearer once we look at the code, let's start importing the required packages.</p>
<pre><code class="language-python">import pandas as pd
import numpy as np
import seaborn as sns
import random
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, LSTM, Dropout
from tensorflow.keras.callbacks import TensorBoard
import time
import matplotlib.pyplot as plt
</code></pre>
<p>This will import Pandas, Numpy, all the Tensorflow functions we need to train our model and a couple of other useful packages.</p>
<p>Next, we want to define some constants, and load our data from csv (in case you are writing the training code on a different file:</p>
<pre><code class="language-python">WINDOW = 10 # how many time units we are going to use to evaluate the future value, in our case each time unit is 15 minutes so we are going to look at 15 * 10 = 150 minutes trading data
LOOKAHEAD = 5 # how far ahead we want to estimate if the future prices is going to be higher or lower? In this case is 5 * 15 = 75 minutes in the future
VALIDATION_SAMPLES = 100 # We want to validate our model on data that wasn't used for the training, we are establishing how many data point we are going to use here.

data = pd.read_csv('./data.csv')
data['future_value'] = data['c'].shift(-LOOKAHEAD) # This allows us to define a new column future_value with as the value of c 5 time units in the future
data.drop([
    'open_time'
], axis=1, inplace=True) # we don't care about the timestamp for predicting future prices
</code></pre>
<p>Let's define a function that allows us to define if the future value is higher or lower than the current close price:</p>
<pre><code class="language-python">def define_output(last, future):
    if future &gt; last:
        return 1
    else:
        return 0
</code></pre>
<p>Simply set the target as 0 if the price is lower or equal than the current close and 1 if it is higher.
Now let's define a function that allows us to create the moving time windows we need  to feed to our neural network:</p>
<pre><code class="language-python">def sequelize(x):
    data = x.copy()
    buys = []
    sells = []
    holds = []
    data_length = len(data)
    for index, row in data.iterrows():
        if index &lt;= data_length - WINDOW:
            last_index = index + WINDOW -1
            rowset = data[index : index + WINDOW]
            row_stats = rowset.describe().transpose()
            last_close = rowset['c'][last_index]
            future_close = rowset['future_value'][last_index]
            rowset = 2 * (rowset - row_stats['min'])  / (row_stats['max'] - row_stats['min']) - 1
            rowset.drop(['future_value'], axis=1, inplace=True)
            rowset.fillna(0, inplace=True)
            category = define_output(last_close, future_close)
            if category == 1:
                buys.append([rowset, category])
            elif category == 0:
                sells.append([rowset, category])
    min_len = min(len(sells), len(buys))
    results = sells[:min_len] + buys[:min_len]
    return results

sequences = sequelize(data)
</code></pre>
<p>Oh ok, that's a lot of stuff going on there. Let's look at it bit by bit:</p>
<pre><code class="language-python">    data = x.copy() # let's copy the dataframe, just in case
    buys = []
    sells = []
    holds = []
    data_length = len(data)
</code></pre>
<p>Here we are doing some preliminary stuff, copy the dataframe to ensure we don't override it (it can be annoying if you are using Jupyter Notebook for example) and setting up arrays for buys and sells, which we'll use to balance our data.</p>
<pre><code class="language-python">    for index, row in data.iterrows():
        if index &lt;= data_length - WINDOW:
            last_index = index + WINDOW -1
            rowset = data[index : index + WINDOW]
</code></pre>
<p>As we iterate each row in the dataset if the index is greater than our defined window size, we can create a new slice of the dataset that is the size of our window size. Before we store this data in another array we need to normalize it with the following code:</p>
<pre><code class="language-python">row_stats = rowset.describe().transpose()
last_close = rowset['c'][last_index]
future_close = rowset['future_value'][last_index] # we'll need to save this separately from the rest of the data
rowset = 2 * (rowset - row_stats['min'])  / (row_stats['max'] - row_stats['min']) - 1
</code></pre>
<p>And we also want to remove the future_value from our dataset as well as replacing any possible NaN with 0s (not ideal good enough for our purpose):</p>
<pre><code class="language-python">rowset.drop(['future_value'], axis=1, inplace=True)
rowset.fillna(0, inplace=True)
</code></pre>
<p>Finally we want to ensure that our sells and buys are balanced, if one occurs more often than the other, our network will quickly get biased toward the skew and not provide us with reliable estimations:</p>
<pre><code class="language-python">            if category == 1:
                buys.append([rowset, category])
            elif category == 0:
                sells.append([rowset, category])
    # the following 2 lines will ensure that we have an equal amount of buys and sells
    min_len = min(len(sells), len(buys))
    results = sells[:min_len] + buys[:min_len]
    return results
</code></pre>
<p>Finally we run this function on our data <code>sequences = sequelize(data)</code></p>
<p>It's also a good idea to randomize our data, so that our model is not influenced by the precise order our dataset is sorted by, the following code will randomize the dataset, split training vs testing dataset and displaying the distribution of buys vs sells in both datasets. Feel free to rerun this snippet to ensure a more balanced distribution of buys and sells:</p>
<pre><code class="language-python">random.shuffle(sequences)
def split_label_and_data(x):
    length = len(x)
    data_shape = x[0][0].shape
    data = np.zeros(shape=(len(x),data_shape[0],data_shape[1]))
    labels = np.zeros(shape=(length,))
    for index in range(len(x)):
        labels[index] = x[index][1]
        data[index] = x[index][0]
    return data, labels
x_train, y_train = split_label_and_data(sequences[: -VALIDATION_SAMPLES])
x_test, y_test = split_label_and_data(sequences[-VALIDATION_SAMPLES :])
sns.distplot(y_test)
sns.distplot(y_train)
len(y_train)
</code></pre>
<p><img alt="Dataset result" src="https://ipfs.infura.io/ipfs/QmRwCWoLMrUkRxuQHAaJohdAXsFAz3ay23gd6mxRgdqSA2" /></p>
<p>After running the snippet a couple of time, you should get something like this, with an even split of buys and sells (left vs right) across both datasets.</p>
<h3 id="training-the-models">Training the model(s)</h3>
<p>We are now ready to train the model, but as we have yet to explore what hyper-parameters work best with our model and data we'll try a slightly more complex approach. First let's define four hyper-parameters arrays:</p>
<pre><code class="language-python">DROPOUTS = [
    0.1,
    0.2,
]
HIDDENS = [
    32,
    64,
    128
]
OPTIMIZERS = [
    'rmsprop',
    'adam'
]
LOSSES = [
    'mse',
    'binary_crossentropy'
]
</code></pre>
<p>Then we'll iterate through each array to train a model with that combinations of hyper parameters, so that we can later compare them using TensorBoard:</p>
<pre><code class="language-python">for DROPOUT in DROPOUTS:
    for HIDDEN in HIDDENS:
        for OPTIMIZER in OPTIMIZERS:
            for LOSS in LOSSES:
                train_model(DROPOUT, HIDDEN, OPTIMIZER, LOSS)
</code></pre>
<p>Now we need to define the <code>train_model</code> function that will actually create and train the model:</p>
<pre><code class="language-python">def train_model(DROPOUT, HIDDEN, OPTIMIZER, LOSS):
    NAME = f&quot;{HIDDEN} - Dropout {DROPOUT} - Optimizer {OPTIMIZER} - Loss {LOSS} - {int(time.time())}&quot;
    tensorboard = TensorBoard(log_dir=f&quot;logs/{NAME}&quot;, histogram_freq=1)

    model = Sequential([
        LSTM(HIDDEN, activation='relu', input_shape=x_train[0].shape),
        Dropout(DROPOUT),
        Dense(HIDDEN, activation='relu'),
        Dropout(DROPOUT),
        Dense(1, activation='sigmoid')
    ])
    model.compile(
        optimizer=OPTIMIZER,
        loss=LOSS,
        metrics=['accuracy']
    )
    model.fit(
        x_train,
        y_train,
        epochs=60,
        batch_size=64,
        verbose=1,
        validation_data=(x_test, y_test),
        callbacks=[
            tensorboard
        ]
    )
</code></pre>
<p>For now this is a very simple model with an LSTM layer as the first layer, one Dense intermediate layer and one Dense output layer of size 1 and <code>sigmoid</code> activation. This layer will output the probability (ranging from 0 to 1) that a specific sequence of size <code>WINDOW</code> will be followed by a higher closing price after <code>LOOKAHEAD</code> intervals, where 0 is a high probability of a lower closing price and 1 is a high probability of a higher closing price.</p>
<p>We are also adding a Tensorboard callback, which will allow us to see how each model performs over each training cycle (EPOCH)</p>
<p>Feel free to run this code and then run Tensorboard, in your terminal <code>tensorboard --logdir=logs</code></p>
<h3 id="feature-engineering">Feature engineering</h3>
<p>The best model should have an accuracy on the validation data that is higher than 60%, which is already quite good. However, we can improve our model very quickly by extracting more data from our existing data set. The process of extracting new features from existing features is called <code>Feature Engineering</code>. Examples of feature engineering would be extracting a weekend boolean column from a data, or a country from a coordinates pair. In our case we are going to add technical analysis data to our OHLC dataset.</p>
<p>At the top of your notebook or file, add the <code>ta</code> package: <code>from ta import *</code>.</p>
<p>Just after loading the data from csv, add the following line, which will append TA data to our existing dataset in the form of new columns</p>
<pre><code class="language-python">data = pd.read_csv('./data.csv')
##add the following line
add_all_ta_features(data, &quot;o&quot;, &quot;h&quot;, &quot;l&quot;, &quot;c&quot;, &quot;v&quot;, fillna=True) 
data['future_value'] = data['c'].shift(-LOOKAHEAD)
</code></pre>
<p>That's it, in a few line we have massively enriched our dataset. We can now run the model generator loop to figure out how our models perform with the new dataset, this will take quite a bit longer, but should be worth the wait.</p>
<p><img alt="" src="https://ipfs.infura.io/ipfs/QmdvN4dQGfGqdhDxuaQWg7kzEvtneccnDrjUcTFa8XwYJY" /></p>
<p>A richer, more meaningful dataset should ensure a more accurate model, and in the image above, we can clearly see how the richer dataset perform better than the simple data-set, with a validation accuracy hovering around the 80% mark!</p>
<h3 id="evaluating-the-best-performing-models">Evaluating the best performing models.</h3>
<p>Now that we have some models that seem to perform nicely on paper, how do we evaluate which one should be used in an hypothetical trading system?</p>
<p>This can be quite subjective, but in my opinion a good approach would be to separately looks at the buys and sells from the known validation labels and plot the distribution of the corresponding predictions. Hopefully, for all the buys, our model mostly predicts buys and not many sells and viceversa.</p>
<p>Let's define a function that displays such chart for each model:</p>
<pre><code class="language-python">def display_results(NAME, y_test, predictions):
    plt.figure()
    buys = []
    sells = []
    for index in range(len(y_test)):
        if y_test[index] == 0:
            sells.append(predictions[index])
        elif y_test[index] == 1:
            buys.append(predictions[index])
    sns.distplot(buys, bins=10, color='green').set_title(NAME)
    sns.distplot(sells, bins=10, color='red')
    plt.show()
</code></pre>
<p>and let's now call this function every time we finish training on a model:</p>
<pre><code class="language-python">    model.fit(
        x_train,
        y_train,
        epochs=60,
        batch_size=64,
        verbose=0,
        validation_data=(x_test, y_test),
        callbacks=[
            tensorboard
        ]
    )
    # after the model.fit call, add the following 2 lines.
    predictions = model.predict(x_test)
    display_results(NAME, y_test, predictions)
</code></pre>
<p>As the different models train we should now see images similar to the below, where the buys are plotted in green (and we want them on the right end side, clustered around the 1 value) and the sells are plotted in red (clustered around the 0 values on the left). These should help us decide which model provides a more reliable estimation of future prices.</p>
<p><img alt="" src="https://ipfs.infura.io/ipfs/QmWJ4Zjwiwi5814oKRi7FF8tgEWQRXfC92FYGneX9qydmc" /></p>
<p>And that's it, we now have a few prototypes to play with that provide a decent estimation of future prices.
As an exercise for yourself try the following:
- What happens if you increase the number of hidden layers of the network? 
- What happens if your datasets is unbalanced?
- What happens if you increase the DROPOUT value?
- What happens if you test your best model on new data? (e.g. by fetching a different timestamp from Binance?</p>
<p>If you have any question or suggestion, please feel free to comment below or suggest an update to this article :)</p>
<hr />
<ul>
<li><strong>Kauri original title:</strong> Predict cryptocurrency prices with Tensorflow as binary classification problem</li>
<li><strong>Kauri original link:</strong> https://kauri.io/predict-cryptocurrency-prices-with-tensorflow-as-b/badf8853afb9404196bd8b5cbeec61a2/a</li>
<li><strong>Kauri original author:</strong> Davide Scalzo (@davidescalzo)</li>
<li><strong>Kauri original Publication date:</strong> 2019-10-22</li>
<li><strong>Kauri original tags:</strong> cryptocurrency, artificial-intelligence, machine-learning, tensorflow, python</li>
<li><strong>Kauri original hash:</strong> QmYUnZ97LSC2zY2ZVRt9SthQEM2kjRusTzqaGaX3yikjra</li>
<li><strong>Kauri original checkpoint:</strong> QmSRv329t5c2hpHHf1Yz4XZomqgeBc8LVh9KNJC9z4PVDS</li>
</ul></div>
                <footer>
    <div class="footer-buttons">
        <div class="previous"><a href="../regression-with-python-keras-and-tensorflow/" title="Regression with Python, Keras and Tensorflow"><span>Previous</span></a></div>
        <div class="next"><a href="../multi-class-classification-example-with-convoluti/" title="Multi-class classification example with Convolutional Neural Network in Keras and Tensorflow"><span>Next</span></a></div>
    </div>
    <div class="footer-note">
        <p>
            Built with <a href="http://www.mkdocs.org">MkDocs</a> using
            <a href="https://github.com/daizutabi/mkdocs-ivory">Ivory theme</a>.
        </p>
    </div>
</footer>
            </div>
        </main>
    </div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js"></script>
    <script src="../../../search/main.js"></script>
</body>

</html>