<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <title>Truffle Testing your smart contract &mdash; archive.kauri.io</title>
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/tonsky/FiraCode@1.206/distr/fira_code.css">
    <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.8.1/css/all.css">
    <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.8.1/css/v4-shims.css">
    <link rel="stylesheet" href="../../../css/theme.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
    <link rel="stylesheet" href="../../../css/extra.css">
    <script src="//code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/solidity.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/rust.min.js"></script>
    <script>
        hljs.initHighlightingOnLoad();
    </script> 
</head>

<body ontouchstart="">
    <div id="container">
        <aside>
            <div class="home">
                <div class="title">
                    <button class="hamburger"></button>
                    <a href="../../.." class="site-name"> archive.kauri.io</a>
                </div>
                <div class="search">
                    <div role="search">
    <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
        <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
    </form>
</div>
                </div>
            </div>
            <nav class="nav">
                <ul class="root">
                    <li class="toctree-l1"><a class="nav-item" href="../../..">Home</a></li>
                    <li class="toctree-l1"><button class="section nav-item">Communities</button>
<ul class="subnav">
    <li class="toctree-l2"><button class="section nav-item hide">Getting started with dapp development</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/tips-for-starting-dapp-development/">Tips for Starting Dapp Development</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/an-introduction-to-solidity-for-experienced-devel/">An Introduction to Solidity for Experienced Developers</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/truffle--adding-a-frontend-with-react-box/">Truffle  Adding a frontend with react box</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/truffle--testing-your-smart-contract/">Truffle  Testing your smart contract</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/truffle--smart-contract-compilation-and-deploymen/">Truffle  Smart Contract Compilation & Deployment</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/understanding-smart-contract-compilation-and-depl/">Understanding smart contract compilation and deployment</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/tools-for-dapp-development/">Tools for dApp development</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/full-stack-dapp-tutorial-series-intro/">Full Stack dApp Tutorial Series - Intro</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/erc-721-non-fungible-token-standard/">ERC-721 Non-Fungible Token Standard</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/create-a-%22hello-world%22-fullstack-dapp/">Create a "Hello World" fullstack dapp</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/a-fullstack-dapp-for-creating-tokens/">A fullstack dapp for creating tokens</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/a-fullstack-dapp-for-creating-unique-tradable-tok/">A fullstack dapp for creating unique tradable tokens</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/blockchain-explained/">Blockchain Explained</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/remix-ide-your-first-smart-contract/">Remix IDE - Your first smart contract</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Getting%20started%20with%20dapp%20development/an-introduction-to-smart-contracts-with-solidity/">An Introduction to Smart Contracts with Solidity</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Java Ethereum</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/how-to-test-ethereum-smart-contracts-from-java/">How to test Ethereum smart contracts from Java</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/web3j-transaction-managers/">Web3j Transaction Managers</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/manage-erc20-tokens-in-java-with-web3j/">Manage ERC20 tokens in Java with Web3j</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/running-a-pantheon-node-in-java-integration-tests/">Running a Pantheon Node in Java Integration Tests</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/managing-storage-in-a-java-application-with-ipfs/">Managing storage in a Java application with IPFS</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/using-besu-the-java-ethereum-client-with-linuxmac/">Using Besu, the Java Ethereum Client with Linux/MacOS</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/listening-for-ethereum-smart-contract-events-in-j/">Listening for Ethereum Smart Contract Events in Java</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/interacting-with-an-ethereum-smart-contract-in-ja/">Interacting with an Ethereum Smart Contract in Java</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/generate-a-java-wrapper-from-your-smart-contract/">Generate a Java Wrapper from your Smart Contract</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/manage-an-ethereum-account-with-java-and-web3j/">Manage an Ethereum account with Java and Web3j</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Java%20Ethereum/connecting-to-an-ethereum-client-with-java-eclips/">Connecting to an Ethereum client with Java, Eclipse and Web3j</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Ethereum Node Runners</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Ethereum%20Node%20Runners/run-an-ethereum-node-on-debian-with-an-external-s/">Run an Ethereum node on Debian with an External SSD (Mar 2020)</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Ethereum%20Node%20Runners/ethereum-on-arm.-turn-your-arm-device-into-a-full/">Ethereum on ARM. Turn your ARM device into a full Ethereum node just by flashing a MicroSD card</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Ethereum%20Node%20Runners/make-use-of-your-remote-ethereum-node-using-an-ss/">Make use of your remote Ethereum node using an SSH tunnel and MetaMask</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Ethereum%20Node%20Runners/how-to-install-and-synchronize-your-own-remote-et/">How to install and synchronize your own remote Ethereum node</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Ethereum%20Node%20Runners/how-to-set-up-a-simple-linux-firewall/">How to set up a simple Linux firewall</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Ethereum%20Node%20Runners/supported-hardware-to-run-an-ethereum-node/">Supported hardware to run an Ethereum node</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Ethereum%20Node%20Runners/monitor-your-geth-node-with-google-sheet/">Monitor your Geth node with Google Sheet</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Ethereum%20Node%20Runners/running-an-ethereum-full-node-on-a-raspberrypi-4-/">Running an Ethereum Full Node on a RaspberryPi 4 (model B)</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">IPFS</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/building-a-twitter-bot-using-ipfs-cluster/">Building a Twitter Bot using IPFS Cluster 🤖</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/hands-on-ipld-tutorial-in-golang--part-2/">Hands-on IPLD Tutorial in Golang  PART 2</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/understanding-ipfs-in-depth%2826%29--what-is-interpla/">Understanding IPFS in Depth(2/6)  What is InterPlanetary Linked Data(IPLD)?</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/hands-on-ipld-tutorial-in-golang/">Hands-on IPLD Tutorial in Golang</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/understanding-ipfs-in-depth%2816%29--a-beginner-to-ad/">Understanding IPFS in Depth(1/6)  A Beginner to Advanced Guide</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/orbitdb--serverless-distributed-peer-to-peer-data/">OrbitDB  Serverless, Distributed, Peer-to-Peer Database</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/getting-started-with-mahuta-a-search-engine-for-t/">Getting started with Mahuta - A Search engine for the IPFS</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/peer-to-peer-hypermedia-with-ipfs/">Peer-to-peer hypermedia with IPFS</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/installing-ipfs/">Installing IPFS</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/improving-ipfs-decentralization-introducing-ahken/">Improving IPFS Decentralization - Introducing Ahken</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/IPFS/managing-storage-in-a-java-application-with-ipfs/">Managing storage in a Java application with IPFS</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Documentation and technical communication</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Documentation%20and%20technical%20communication/why-do-people-write/">Why do people write?</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Documentation%20and%20technical%20communication/language-and-understandable-writing/">Language and understandable writing</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Documentation%20and%20technical%20communication/documentation-structure/">Documentation structure</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../../communities/Documentation%20and%20technical%20communication/why-write-documentation/">Why write documentation</a></li>
</ul></li>
</ul></li>
                    <li class="toctree-l1"><button class="section nav-item">Collections</button>
<ul class="subnav">
    <li class="toctree-l2"><button class="section nav-item hide">A Deep Dive Into The Ethereum Virtual Machine (EVM) Series</button>
<ul class="subnav hide">
    <li class="toctree-l3">
<a class="nav-item" href="../../A%20Deep%20Dive%20Into%20The%20Ethereum%20Virtual%20Machine%20%28EVM%29%20Series/a-deep-dive-into-the-ethereum-virtual-machine-%28ev/">A Deep Dive into the Ethereum Virtual Machine (EVM) - part 1  Introduction</a></li>
    <li class="toctree-l3">
<a class="nav-item" href="../../A%20Deep%20Dive%20Into%20The%20Ethereum%20Virtual%20Machine%20%28EVM%29%20Series/a-deep-dive-into-the-ethereum-virtual-machine-%28ev/">A Deep Dive into the Ethereum Virtual Machine (EVM) - part 2  Memory and Storage</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Deep%20Dive%20Into%20The%20Ethereum%20Virtual%20Machine%20%28EVM%29%20Series/a-deep-dive-into-the-ethereum-virtual-machine-%28ev/">A Deep Dive into the Ethereum Virtual Machine (EVM) - Part 3  Execution Model of the EVM</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Deep%20Dive%20Into%20The%20Ethereum%20Virtual%20Machine%20%28EVM%29%20Series/a-deep-dive-into-the-ethereum-virtual-machine-par/">A Deep Dive into the Ethereum Virtual Machine - Part 4  The EVM and High-Level Programming Languages</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Build your very own self-hosting platform with Raspberry Pi and Kubernetes</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Build%20your%20very%20own%20self-hosting%20platform%20with%20Raspberry%20Pi%20and%20Kubernetes/%2818%29-build-your-very-own-self-hosting-platform-wi/">(1/8) Build your very own self-hosting platform with Raspberry Pi and Kubernetes - Introduction</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Build%20your%20very%20own%20self-hosting%20platform%20with%20Raspberry%20Pi%20and%20Kubernetes/%2828%29-install-raspbian-operating-system-and-prepar/">(2/8) Install Raspbian Operating-System and prepare the system for Kubernetes</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Build%20your%20very%20own%20self-hosting%20platform%20with%20Raspberry%20Pi%20and%20Kubernetes/%2838%29-install-and-configure-a-kubernetes-cluster-w/">(3/8) Install and configure a Kubernetes cluster with k3s to self-host applications</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Build%20your%20very%20own%20self-hosting%20platform%20with%20Raspberry%20Pi%20and%20Kubernetes/%2848%29-deploy-nextcloud-on-kuberbetes--the-self-hos/">(4/8) Deploy NextCloud on Kuberbetes  The self-hosted Dropbox</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Build%20your%20very%20own%20self-hosting%20platform%20with%20Raspberry%20Pi%20and%20Kubernetes/%2858%29-self-host-your-media-center-on-kubernetes-wi/">(5/8) Self-host your Media Center On Kubernetes with Plex, Sonarr, Radarr, Transmission and Jackett</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Build%20your%20very%20own%20self-hosting%20platform%20with%20Raspberry%20Pi%20and%20Kubernetes/%2868%29-self-host-pi-hole-on-kubernetes-and-block-ad/">(6/8) Self-host Pi-Hole on Kubernetes and block ads and trackers at the network level</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Build%20your%20very%20own%20self-hosting%20platform%20with%20Raspberry%20Pi%20and%20Kubernetes/%2878%29-self-host-your-password-manager-with-bitward/">(7/8) Self-host your password manager with Bitwarden</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Build%20your%20very%20own%20self-hosting%20platform%20with%20Raspberry%20Pi%20and%20Kubernetes/%2888%29-deploy-prometheus-and-grafana-to-monitor-a-k/">(8/8) Deploy Prometheus and Grafana to monitor a Kubernetes cluster</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">A Hackathon Survival Guide</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/the-hack%21-what-is-a-hackathon/">The Hack?!? What is a hackathon?</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/create-a-%22hello-world%22-fullstack-dapp/">Create a "Hello World" fullstack dapp</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/full-stack-dapp-tutorial-series-intro/">Full Stack dApp Tutorial Series - Intro</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/ethereum-101-part-1-what-is-ethereum/">Ethereum 101 - Part 1 - What is Ethereum?</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/remix-ide-your-first-smart-contract/">Remix IDE - Your first smart contract</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/interacting-with-an-ethereum-smart-contract-in-ja/">Interacting with an Ethereum Smart Contract in Java</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/a-.net-developer-s-workflow-for-creating-and-call/">A .NET Developer’s Workflow for Creating and Calling Ethereum Smart Contracts</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/sending-ethereum-transactions-with-rust/">Sending Ethereum Transactions with Rust</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/generate-a-java-wrapper-from-your-smart-contract/">Generate a Java Wrapper from your Smart Contract</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/accelerating-dapp-development-with-ethers.js/">Accelerating DApp Development with Ethers.js</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/nethereum-an-open-source-.net-integration-library/">Nethereum - An open source .NET integration library for blockchain</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/creating-a-dapp-in-go-with-geth/">Creating a DApp in Go with Geth</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/tools-for-dapp-development/">Tools for dApp development</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/ethasketch/">EthASketch</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/bountibot--rewarding-github-pull-requests-for-you/">Bountibot  rewarding GitHub Pull Requests for you and the rest of the OSS community</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20Hackathon%20Survival%20Guide/eth-dev-tools/">ETH Dev Tools</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Web3j Cheat Sheet (Java Ethereum)</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Web3j%20Cheat%20Sheet%20%28Java%20Ethereum%29/retrieving-an-ethereum-account-balance-in-web3j/">Retrieving an Ethereum Account Balance in Web3j</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Web3j%20Cheat%20Sheet%20%28Java%20Ethereum%29/converting-between-ether-units-denominations-in-w/">Converting Between Ether Units / Denominations in Web3j</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Web3j%20Cheat%20Sheet%20%28Java%20Ethereum%29/creating-a-web3j-wallet-from-a-mnemonic-code-%28see/">Creating a Web3j Wallet from a Mnemonic Code (Seed Phrase)</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Web3j%20Cheat%20Sheet%20%28Java%20Ethereum%29/sending-an-ether-transfer-transaction-from-one-ac/">Sending an Ether Transfer Transaction from One Account to Another in Web3j</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Web3j%20Cheat%20Sheet%20%28Java%20Ethereum%29/signing-an-ethereum-transaction-in-web3j/">Signing an Ethereum Transaction in Web3j</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Web3j%20Cheat%20Sheet%20%28Java%20Ethereum%29/signing-data-in-java-and-web3j/">Signing Data in Java and Web3j</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">OpenZeppelin</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../OpenZeppelin/openzeppelin-part-1--introductory/">OpenZeppelin Part 1  Introductory</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../OpenZeppelin/openzeppelin-part-2--access-control/">OpenZeppelin Part 2  Access Control</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../OpenZeppelin/openzeppelin-part-3--token-standards/">OpenZeppelin Part 3  Token Standards</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../OpenZeppelin/openzeppelin-part-4--crowdsales/">OpenZeppelin Part 4  Crowdsales</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">A non practitioner guide to machine learning</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../A%20non%20practitioner%20guide%20to%20machine%20learning%20/getting-started-with-machine-learning-%28non-practi/">Getting Started With Machine Learning (Non practitioner guide)</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20non%20practitioner%20guide%20to%20machine%20learning%20/installing-anaconda-python3-and-tensorflow/">Installing Anaconda, Python3 and Tensorflow</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20non%20practitioner%20guide%20to%20machine%20learning%20/regression-with-python-keras-and-tensorflow/">Regression with Python, Keras and Tensorflow</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20non%20practitioner%20guide%20to%20machine%20learning%20/predict-cryptocurrency-prices-with-tensorflow-as-/">Predict cryptocurrency prices with Tensorflow as binary classification problem</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../A%20non%20practitioner%20guide%20to%20machine%20learning%20/multi-class-classification-example-with-convoluti/">Multi-class classification example with Convolutional Neural Network in Keras and Tensorflow</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">An ethereum test toolkit in Go</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../An%20ethereum%20test%20toolkit%20in%20Go/sending-transactions-on-geth-s-simulated-backend/">Sending Transactions on GETH's Simulated Backend</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../An%20ethereum%20test%20toolkit%20in%20Go/interacting-with-smart-contracts-from-geth-s-simu/">Interacting with smart contracts from GETH's Simulated Backend</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../An%20ethereum%20test%20toolkit%20in%20Go/generating-a-load-of-keys-for-testing-in-go/">Generating a load of keys for testing in Go</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../An%20ethereum%20test%20toolkit%20in%20Go/the-geth-simulated-backend/">The GETH Simulated Backend</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Monitoring Kubernetes with Elastic Stack</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Monitoring%20Kubernetes%20with%20Elastic%20Stack/%2815%29-getting-started-with-elastic-stack-for-monit/">(1/5) Getting started with Elastic Stack for monitoring on Kubernetes</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Monitoring%20Kubernetes%20with%20Elastic%20Stack/%2825%29-install-elasticsearch-and-kibana-to-store-an/">(2/5) Install ElasticSearch and Kibana to store and visualize monitoring data</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Monitoring%20Kubernetes%20with%20Elastic%20Stack/%2835%29-collect-metrics-with-elastic-metricbeat-for-/">(3/5) Collect metrics with Elastic Metricbeat for monitoring Kubernetes</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Monitoring%20Kubernetes%20with%20Elastic%20Stack/%2845%29-collect-logs-with-elastic-filebeat-for-monit/">(4/5) Collect logs with Elastic Filebeat for monitoring Kubernetes</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Monitoring%20Kubernetes%20with%20Elastic%20Stack/%2855%29-collect-traces-with-elastic-apm-for-monitori/">(5/5) Collect traces with Elastic APM for monitoring Kubernetes</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Founder interviews</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Founder%20interviews/fluree--blockchain-graphql-and-more-all-in-one-da/">Fluree  Blockchain, GraphQL, and more all in one database</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Founder%20interviews/true-anonymity-privacy-and-snapps-with-simon-harm/">True anonymity, privacy, and SNApps with Simon Harman of Loki</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Founder%20interviews/the-aeternity-blockchain-with-emil-wagner/">The Æternity blockchain with Emil Wagner</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Founder%20interviews/embleema--the-blockchain-that-lets-you-own-your-h/">Embleema  The Blockchain That Lets You Own Your Health Data</a></li>
</ul></li>
    <li class="toctree-l2 current"><button class="section nav-item">Vyper Full Stack dApp Tutorial Series</button>
<ul class="subnav">
    <li class="toctree-l3"><a class="nav-item" href="../remix-ide-your-first-vyper-smart-contract/">Remix IDE - Your first Vyper smart contract</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../understanding-smart-contract-compilation-and-depl/">Understanding smart contract compilation and deployment</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../truffle--smart-contract-compilation-and-deploymen/">Truffle  Smart Contract Compilation & Deployment</a></li>
    <li class="toctree-l3 current"><a class="nav-item current" href="./">Truffle  Testing your smart contract</a>
<ul class="subnav">
<li class="toctree-l4"><a class="nav-item toc" href="#truffle-testing-your-smart-contract_1">Truffle: Testing your smart contract</a></li>
</ul></li>
    <li class="toctree-l3"><a class="nav-item" href="../tools-for-working-with-vyper/">Tools for working with Vyper</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Flexible, Upgradeable & Highly Available NFTs</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Flexible%2C%20Upgradeable%20%26%20Highly%20Available%20NFTs/creating-a-flexible-nft-%28part-1%29/">Creating a Flexible NFT (Part 1)</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Flexible%2C%20Upgradeable%20%26%20Highly%20Available%20NFTs/creating-a-flexible-nft-%28part-2%29/">Creating a Flexible NFT (Part 2)</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Libra</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Libra/building-and-working-with-facebook-s-cryptocurren/">Building and Working with Facebook’s Cryptocurrency Libra</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Libra/whitepaper-deep-dive-move--facebook-libra-blockch/">Whitepaper Deep Dive — Move  Facebook Libra Blockchain’s New Programming Language</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Libra/quick-dive-into-the-move-programming-language/">Quick Dive into the Move Programming Language</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Bitcoin</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Bitcoin/bitcoin-blockchain-overview/">Bitcoin Blockchain Overview</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Bitcoin/creating-bitcoin-transactions/">Creating Bitcoin Transactions</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Bitcoin/bitcoin-contract-scripts/">Bitcoin Contract Scripts</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Bitcoin/lightning-at-home/">Lightning at Home</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Bitcoin/lnd-overview-and-developer-guide/">LND Overview and Developer Guide</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Getting Started</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/blockchain-explained/">Blockchain Explained</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/an-introduction-to-smart-contracts-with-solidity/">An Introduction to Smart Contracts with Solidity</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/an-introduction-to-smart-contracts-with-vyper/">An Introduction to Smart Contracts with Vyper</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/cute-kitties-and-where-to-find-them-an-introducti/">Cute Kitties and Where to Find Them — An Introduction to Non-Fungible Tokens</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/erc-721-non-fungible-token-standard/">ERC-721 Non-Fungible Token Standard</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/erc-20-token-standard/">ERC-20 Token Standard</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/develop-your-erc-20-token-explained%21/">Develop your ERC-20 Token — explained!</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/gamifying-crypto-assets-with-the-erc998-composabl/">Gamifying Crypto Assets with the ERC998 Composables Token Standard</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/erc-20-and-its-discontents--the-rise-of-comrades-/">ERC-20 and Its Discontents  The Rise of Comrades ERC-777 & ERC-1820</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/creating-a-dapp-in-go-with-geth/">Creating a DApp in Go with Geth</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/smart-contracts-integration-with-nethereum/">Smart contracts integration with Nethereum</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/signing-messages-with-nethereum/">Signing messages with Nethereum</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/managing-nonces-with-nethereum/">Managing nonces with Nethereum</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Getting%20Started/connecting-to-an-ethereum-client-with-java-eclips/">Connecting to an Ethereum client with Java, Eclipse and Web3j</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Privacy</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/introduction-to-cryptography/">Introduction to Cryptography</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/building-on-bulletproofs-short-proofs-for-confide/">Building on Bulletproofs - Short Proofs for Confidential Transactions</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/enigma-protocol/">Enigma Protocol</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/how-to-code-your-own-confidential-token-on-ethere/">How to Code Your Own Confidential Token on Ethereum</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/data-privacy-with-the-nucypher-network/">Data Privacy with the NuCypher Network</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/nucypher-pyumbral/">NuCypher - PyUmbral</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/nightfall-private-token-and-nft-transfers-on-ethe/">Nightfall - Private Token and NFT Transfers on Ethereum</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/privacy-with-pantheon-ethereum-java-client/">Privacy with Pantheon Ethereum Java Client</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/parity-private-transactions/">Parity - Private Transactions</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/introducing-beam%21/">Introducing Beam!</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/a-short-history-of-mimblewimble--from-hogwarts-to/">A Short History of Mimblewimble  From Hogwarts to Mobile Wallets</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/why-beam-is-sound-money/">Why Beam is Sound Money</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/introduction-to-mimblewimble-and-grin/">Introduction to MimbleWimble and Grin</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/a-beginner-s-guide-to-zcash/">A beginner’s guide to Zcash</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Privacy/a-beginner-s-guide-to-monero/">A beginner’s guide to Monero</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">Open Finance (DeFi)</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../Open%20Finance%20%28DeFi%29/kyber-network--on-chain-liquidity-protocol/">Kyber Network  On-chain liquidity protocol</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Open%20Finance%20%28DeFi%29/compound--money-markets-on-ethereum/">Compound  Money markets on Ethereum</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Open%20Finance%20%28DeFi%29/0x--peer-to-peer-exchange-protocol/">0x  Peer-to-peer exchange protocol</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Open%20Finance%20%28DeFi%29/makerdao--decentralized-stablecoin-and-collateral/">MakerDAO  Decentralized stablecoin and collateral loans</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Open%20Finance%20%28DeFi%29/uniswap--protocol-for-automated-token-exchange/">Uniswap  Protocol for automated token exchange</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Open%20Finance%20%28DeFi%29/set-protocol--baskets-of-tokenized-assets/">Set Protocol  Baskets of tokenized assets</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Open%20Finance%20%28DeFi%29/an-introduction-to-bonding-curves/">An Introduction to Bonding Curves</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../Open%20Finance%20%28DeFi%29/incentivizing-high-quality-curation-with-a-token-/">Incentivizing high-quality curation with a Token-Curated Registry</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">DevOps</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../DevOps/lint-your-solidity-contracts-with-solhint/">Lint your Solidity contracts with Solhint</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../DevOps/lint-your-solidity-contracts-with-ethlint/">Lint your Solidity contracts with Ethlint</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../DevOps/truffle--testing-your-smart-contract/">Truffle  Testing your smart contract</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../DevOps/truffle-101-development-tools-for-smart-contracts/">Truffle 101 - Development Tools for Smart Contracts</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../DevOps/analyze-solidity-smart-contracts-with-slither/">Analyze Solidity Smart Contracts with Slither</a></li>
</ul></li>
    <li class="toctree-l2"><button class="section nav-item hide">SecureETH</button>
<ul class="subnav hide">
    <li class="toctree-l3"><a class="nav-item" href="../../SecureETH/system-description-document/">System Description Document</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../SecureETH/secureth-guidelines-getting-started/">SecurEth Guidelines - Getting Started</a></li>
    <li class="toctree-l3"><a class="nav-item" href="../../SecureETH/secureth-guidelines-introduction/">SecurEth Guidelines Introduction</a></li>
</ul></li>
</ul></li>
                </ul>
            </nav>
            <div class="repo">
    <div class="previous"><a href="../truffle--smart-contract-compilation-and-deploymen/">&laquo; Previous</a></div>
    <div class="next"><a href="../tools-for-working-with-vyper/">Next &raquo;</a></div>
</div>
        </aside>
        <div id="spacer"><button class="arrow"></button></div>
        <main>
            <div class="home-top">
                <button class="hamburger"></button>
                <a href="../../.." class="site-name"> archive.kauri.io</a>
            </div>
            <div id="main">
                <nav class="breadcrumbs">
<ul>
    <li>Collections &raquo; </li><li>Vyper Full Stack dApp Tutorial Series</li>
</ul>
</nav>
                <div id="content"><h1 id="truffle-testing-your-smart-contract">Truffle  Testing your smart contract</h1>
<h2 id="truffle-testing-your-smart-contract_1">Truffle: Testing your smart contract</h2>
<p>Earlier in this series, we took a look at how to setup Truffle and use it to compile, deploy and interact with our <em>Bounties.vy</em> smart contract.</p>
<p>This article covers the steps required to write tests for our smart contract within the Truffle framework. You can write tests in Truffle projects using <a href="http://truffleframework.com/docs/getting_started/javascript-tests">Javascript</a> thanks to the <a href="https://mochajs.org/">Mocha</a> testing framework and <a href="http://www.chaijs.com/api/assert/">Chai</a> for assertions. This article focuses on the Javascript tests.</p>
<p><a href="https://github.com/iamonuwa/Bounties">You can find source code for this tutorial on GitHub</a>.</p>
<h3 id="prerequisites">Prerequisites</h3>
<h4 id="nodejs-76">NodeJS 7.6</h4>
<p>Since web3.js and truffle executions are asynchronous, we use <a href="https://hackernoon.com/6-reasons-why-javascripts-async-await-blows-promises-away-tutorial-c7ec10518dd9">async/await</a> to simplify our test code and you need Node 7.6 or higher.</p>
<h4 id="truffle">Truffle</h4>
<pre><code class="language-shell">npm install -g truffle
</code></pre>
<p>Read more on <a href="https://truffleframework.com/docs/truffle/getting-started/installation">installing truffle in their docs</a>.</p>
<h4 id="truffle-project">Truffle Project</h4>
<p>In order to test our <em>Bounties.vy</em> smart contract we need to have a truffle project set up to compile and deploy our smart contract. Let's start with the truffle project we created earlier in the series:</p>
<!-- TODO: Update -->

<pre><code class="language-shell">$ git clone https://github.com/iamonuwa/Bounties.git
$ cd Bounties
</code></pre>
<!-- TODO: No package.json at this time -->

<h4 id="development-blockchain-ganache-cli">Development Blockchain: Ganache-CLI</h4>
<p>In order to deploy our smart contract, we need an Ethereum environment to deploy to. For this, we use Ganache-CLI to run a local development environment</p>
<p><strong>NOTE</strong>: If you have a windows machine you need to install the windows developer tools first:</p>
<pre><code class="language-shell">npm install -g windows-build-tools
</code></pre>
<p>Windows users should also install promise and bindings to ensure there are no errors later:</p>
<pre><code class="language-shell">npm install mz
npm install bindings
</code></pre>
<p>Then run:</p>
<pre><code class="language-shell">npm install -g ganache-cli
</code></pre>
<h3 id="setting-up-a-test-file">Setting up a test file</h3>
<p>Now that we have our project setup we can create our first test:</p>
<ul>
<li>First, create a file named <strong>bounties.js</strong> inside the <strong>/test</strong> folder</li>
<li>Within our <strong>bounties.js</strong> file we need to import the <strong>Bounties.vy</strong> artifact so we can use it within our tests</li>
</ul>
<pre><code class="language-javascript">const Bounties = artifacts.require(&quot;Bounties&quot;);
</code></pre>
<ul>
<li>Now define a contract container where our tests for this contract live, usually this is the name of the contract, however, this is not required, you can use any text you like.</li>
</ul>
<pre><code class="language-javascript">contract('Bounties', function(accounts) {

  let bountiesInstance;

  beforeEach(async () =&gt; {
      bountiesInstance = await Bounties.new()
    })

});
</code></pre>
<ul>
<li>Within the contract container, we define the <code>bountiesInstance</code> variable to hold the contract instance we are testing, and a <code>beforeEach</code> block</li>
<li>The <code>beforeEach</code> block executes before each test and deploys a new instance of the <em>Bounties.vy</em> smart contract. This ensures each test is executed against a clean contract state</li>
</ul>
<p>Your <em>bounties.js</em> file should look as follows:</p>
<!-- TODO: Code better -->

<p><img alt="" src="https://ipfs.infura.io/ipfs/QmbcpryjzGpp6pVT7J8iw8VxqNvKyQk3e4gwpUrDZHENQh" /></p>
<p>At this point, we have the basic skeleton of our test file and we can test everything is set up correctly by executing the following.</p>
<p>First in a separate window start ganache-cli:</p>
<pre><code class="language-shell">ganache-cli
</code></pre>
<p>Next, run the test command:</p>
<pre><code class="language-shell">truffle test
</code></pre>
<p>Running truffle test executes all tests in your truffle projects <strong>/test</strong> folder. This does the following:</p>
<ol>
<li>Compiles your contracts</li>
<li>Runs migrations to deploy the contracts to the network</li>
<li>Runs tests against the contracts deployed on the network</li>
</ol>
<h3 id="writing-a-test">Writing a Test</h3>
<p>Let's take a look at the <code>issueBounty</code> function:</p>
<pre><code class="language-vyper">@public
@payable
def issueBounty(_data: bytes32, _deadline: timestamp):
    assert msg.value &gt; 0
    assert _deadline &gt; block.timestamp

    bIndex: int128 = self.nextBountyIndex

    self.bounties[bIndex] = Bounty({ issuer: msg.sender, deadline: _deadline, data: _data, status: 0, amount: msg.value })
    self.nextBountyIndex = bIndex + 1

    log.BountyIssued(bIndex, msg.sender, msg.value, _data)
</code></pre>
<p>There are a few things we want to test within this function:</p>
<ul>
<li>Issuing a bounty should emit a <code>BountyIssued</code> event</li>
<li>Calling <code>issueBounty</code> should return an empty object</li>
<li><code>payable</code> keyword: Issuing a bounty without sending a value should fail</li>
<li><code>validationZero</code>:  Issuing a bounty with a value of 0 should fail</li>
<li><code>validateDeadline</code>: Issuing a bounty with a deadline less than or equal to now should fail</li>
</ul>
<h4 id="helper-functions">Helper Functions</h4>
<p>To create our bounty, we need to pass in a deadline which is greater than the current timestamp on the EVM.</p>
<p>To do this we need to write some helper functions to assist us in writing our tests:</p>
<ul>
<li>First, create a folder in the <strong>/test</strong> directory named <strong>utils</strong> and create a file <strong>time.js</strong></li>
<li>Copy the following extract into <strong>time.js</strong></li>
</ul>
<pre><code class="language-javascript">function getCurrentTime() {
  return new Promise(function(resolve) {
    web3.eth.getBlock(&quot;latest&quot;).then(function(block) {
      resolve(block.timestamp)
    });
  })
}

Object.assign(exports, {
  getCurrentTime
});
</code></pre>
<p>The above extract uses the web3 library to get the latest block from the EVM and from that return its timestamp.</p>
<ul>
<li>Create a file named <strong>assertRevert.js</strong> inside the <strong>/test/utils</strong> directory</li>
<li>Copy the following extract into <strong>assertRevert.js</strong></li>
</ul>
<pre><code class="language-javascript">var assertRevert = async (promise, message) =&gt; {
  let noFailureMessage;
  try {
    await promise;

    if (!message) {
      noFailureMessage = 'Expected revert not received'
    } else {
      noFailureMessage = message;
    }

    assert.fail();
  } catch (error) {
    if (noFailureMessage) {
      assert.fail(0, 1, message);
    }
    const revertFound = error.message.search('revert') &gt;= 0;
    assert(revertFound, `Expected &quot;revert&quot;, got ${error} instead`);
  }
};

Object.assign(exports, {
  assertRevert
});
</code></pre>
<p><img alt="" src="https://ipfs.infura.io/ipfs/QmPCxstBZ9dsJVyhZUvUc1zbzSppJkAiQCfTUEGtfphTR3" /></p>
<p>The above extract takes a promise as its first argument, which would be a web3 transaction, and an assertion fail message as the next. It wraps the promise in a try and catches the error, if the promise fails it checks if the error message contains the string "revert”.</p>
<p>We can now import our helper function into our <strong>bounties.js</strong> test file, by adding the following lines:</p>
<pre><code class="language-javascript">const getCurrentTime = require('./utils/time').getCurrentTime;
const assertRevert = require('./utils/assertRevert').assertRevert;
const dayInSeconds = 86400;
</code></pre>
<p>We also added a <code>dayInSeconds</code> constant to help us add days.</p>
<h4 id="happy-path-for-tests">Happy Path for tests</h4>
<p><strong>Note: all the following tests should be placed in the bounties.js file</strong></p>
<p>The test for our first happy path looks like this:</p>
<pre><code class="language-javascript">it(&quot;Should allow a user to issue a new bounty&quot;, async () =&gt; {
    let time = await getCurrentTime();
    let tx = await bountiesInstance.issueBounty(
      &quot;0x736f6d6520726571756972656d656e7473&quot;,
      1691452800,
      { from: accounts[0], value: 500000000000 }
    );
    assert.strictEqual(
      tx.receipt.logs.length,
      1,
      &quot;issueBounty() call did not log 1 event&quot;
    );
    assert.strictEqual(
      tx.logs.length,
      1,
      &quot;issueBounty() call did not log 1 event&quot;
    );
    const logBountyIssued = tx.logs[0];
    assert.strictEqual(
      logBountyIssued.event,
      &quot;BountyIssued&quot;,
      &quot;issueBounty() call did not log event BountyIssued&quot;
    );
    expect(logBountyIssued.args._id).to.eq.BN(0);
    assert.strictEqual(
      logBountyIssued.args._issuer,
      accounts[0],
      &quot;BountyIssued event logged did not have expected issuer&quot;
    );
    assert.strictEqual(
      logBountyIssued.args._amount.toNumber(),
      500000000000,
      &quot;BountyIssued event logged did not have expected amount&quot;
    );
  });
</code></pre>
<p>There is a lot going on here, so let's break it down:</p>
<ul>
<li>Each test starts with the function <code>it()</code> which takes a description of the test as its first arguments and a callback function as the next. We use <code>async()</code> as the callback so we can use <code>await</code>.</li>
<li>We then invoke an <code>issueBounty</code> transaction on our <code>bountiesInstance</code> object, using our <code>getCurrentTIme()</code> helper to ensure our deadline is valid.</li>
<li>The transaction is sent from <code>account[0]</code> with a value of <code>500000000000000000</code>.</li>
<li>We then <code>assert</code> that our transaction receipt contains a log of exactly 1 event.</li>
<li>We then assert that the details of the event are as expected.</li>
<li>Notice, we used <code>expect</code> to check if the <code>id</code> is equal to BigNumber 0. You cannot use the <code>Assert</code> keyword in this case because <code>BN</code> is not a function in it. To test for <code>BN</code>, we had to install <code>bignumber.js</code>, <code>chai</code>, <code>bn-chai</code> using npm and add the following at the beginning of the file:</li>
</ul>
<pre><code class="language-javascript">const BN = require(&quot;bignumber.js&quot;);
const chai = require(&quot;chai&quot;);
const bnChai = require(&quot;bn-chai&quot;);
const { expect } = chai;
chai.use(bnChai(BN));
</code></pre>
<p>Our second happy path tests making a call to <code>issueBounty</code> rather than sending a transaction:</p>
<pre><code class="language-javascript">it(&quot;Should not allow a user to issue a bounty without sending ETH&quot;, async () =&gt; {
    let time = await getCurrentTime()
    assertRevert(bountiesInstance.issueBounty('0x736f6d6520726571756972656d656e7473',
                                time + (dayInSeconds * 2),
                                {from: accounts[0]}), &quot;Bounty issued without sending ETH&quot;);

  });
</code></pre>
<p>Above we add <code>.call</code> to <code>issueBounty</code> to make a call to the function rather than issuing a transaction. This returns the return value of the function rather than a transaction receipt.</p>
<p><strong>NOTE: Because our result is a <code>BigNumber</code>, we need to call <code>.toNumber()</code> in our assert function.</strong></p>
<h4 id="error-path">Error Path</h4>
<p>Our error path tests involve sending a transaction with invalid inputs as an argument to our <code>assertRevert</code> helper function. To test our <code>payable</code> keyword, we invoke a transaction without setting a value:</p>
<pre><code class="language-javascript">it(&quot;Should not allow a user to issue a bounty without sending ETH&quot;, async () =&gt; {
      let time = await getCurrentTime()
      assertRevert(bountiesInstance.issueBounty(&quot;data&quot;,
                                  time + (dayInSeconds * 2),
                                  {from: accounts[0]}), &quot;Bounty issued without sending ETH&quot;);

    });
</code></pre>
<p>To test <code>msg.value &gt; 0</code> we invoke our transaction with a value of 0:</p>
<pre><code class="language-javascript">it(&quot;Should not allow a user to issue a bounty when sending value of 0&quot;, async () =&gt; {
    let time = await getCurrentTime()
    assertRevert(bountiesInstance.issueBounty('0x736f6d6520726571756972656d656e7473',
                                time + (dayInSeconds * 2),
                                {from: accounts[0], value: 0}), &quot;Bounty issued when sending value of 0&quot;);

  });
</code></pre>
<p>To test our <code>_deadline &gt; block.timestamp</code>, we need to send two transactions, one with a deadline set in the past, and another with a deadline set as now:</p>
<pre><code class="language-javascript">it(&quot;Should not allow a user to issue a bounty with a deadline in the past&quot;, async () =&gt; {
    let time = await getCurrentTime()
    assertRevert(bountiesInstance.issueBounty('0x736f6d6520726571756972656d656e7473',
                                time - 1,
                                {from: accounts[0], value: 0}), &quot;Bounty issued with deadline in the past&quot;);

  });

  it(&quot;Should not allow a user to issue a bounty with a deadline of now&quot;, async () =&gt; {
    let time = await getCurrentTime()
    assertRevert(bountiesInstance.issueBounty('0x736f6d6520726571756972656d656e7473',
                                time,
                                {from: accounts[0], value: 0}), &quot;Bounty issued with deadline of now&quot;);

  });
</code></pre>
<p>If we run the <code>truffle test</code> command we should see the following:</p>
<pre><code class="language-shell">$ truffle test

Contract: Bounties
    ✓ Should allow a user to issue a new bounty (92ms)
    ✓ Should return an integer when calling issueBounty (46ms)
    ✓ Should not allow a user to issue a bounty without sending ETH
    ✓ Should not allow a user to issue a bounty when sending value of 0
    ✓ Should not allow a user to issue a bounty with a deadline in the past
    ✓ Should not allow a user to issue a bounty with a deadline of now
    ✓ Should not allow a user to fulfil an existing bounty where the deadline has passed (103ms)


  7 passing (1s)
</code></pre>
<h4 id="time-travel">Time travel</h4>
<p>One of the main tests is to check that a fulfilment should not be accepted if the deadline has passed. In order to test this, we need to add a helper function which advances the timestamp of the EVM.</p>
<p>In the <strong>/test/utils/time.js</strong> file add the following:</p>
<pre><code class="language-javascript">function increaseTimeInSeconds(increaseInSeconds) {
    return new Promise(function(resolve) {
        web3.currentProvider.send({
            jsonrpc: &quot;2.0&quot;,
            method: &quot;evm_increaseTime&quot;,
            params: [increaseInSeconds],
            id: new Date().getTime()
        }, resolve);
    });
};
</code></pre>
<p>This function calls the <code>evm_increaseTime</code> RPC function of the ganache EVM to increase the EVM block timestamp.</p>
<p>Add the new <code>increaseTimeInSeconds</code> function to the exports section of the file:</p>
<pre><code class="language-javascript">Object.assign(exports, {
  increaseTimeInSeconds,
  getCurrentTime
});
</code></pre>
<p>In the <strong>bounties.js</strong> test file add the following line to import our new helper function:</p>
<pre><code class="language-javascript">const increaseTimeInSeconds = require('./utils/time').increaseTimeInSeconds;
</code></pre>
<p>We can then use this in our test as follows:</p>
<pre><code class="language-javascript">it(&quot;Should not allow a user to fulfil an existing bounty where the deadline has passed&quot;, async () =&gt; {
  let time = await getCurrentTime()
  await bountiesInstance.issueBounty(&quot;data&quot;,
                    time+ (dayInSeconds * 2),
                    {from: accounts[0], value: 500000000000});

  await increaseTimeInSeconds((dayInSeconds * 2)+1)

  assertRevert(bountiesInstance.fulfillBounty(0,&quot;data&quot;,{from: accounts[1]}), &quot;Fulfillment accepted when deadline has passed&quot;);

});
</code></pre>
<h3 id="try-it-yourself">Try it yourself</h3>
<p>Now that you have seen how to test the <code>issueBounty</code> function, try adding tests for the following functions:</p>
<ul>
<li><code>fulfilBounty</code></li>
<li><code>acceptFulfilment</code></li>
<li><code>cancelBounty</code></li>
</ul>
<p>You can find the <a href="https://github.com/iamonuwa/Bounties/blob/master/test/bounties.js">complete bounties.js test file here for reference</a></p>
<h3 id="next-steps">Next Steps</h3>
<ul>
<li>Read the next guide: <a href="https://kauri.io/article/86903f66d39d4379a2e70bd583700ecf/truffle:-adding-a-frontend-with-react-box">Truffle: Adding a Frontend with React Box</a></li>
<li>Learn more about the Truffle suite of tools from the <a href="https://truffleframework.com/">website</a></li>
</ul>
<blockquote>
<p>If you enjoyed this guide, or have any suggestions or questions, let me know in the comments.</p>
<p>If you have found any errors, feel free to update this guide by selecting the <strong>'Update Article'</strong> option in the right hand menu, and/or <a href="https://github.com/iamonuwa/Bounties">update the code</a></p>
</blockquote>
<hr />
<ul>
<li><strong>Kauri original title:</strong> Truffle  Testing your smart contract</li>
<li><strong>Kauri original link:</strong> https://kauri.io/truffle-testing-your-smart-contract/ebc4a29cc1c044fdba99631796ffbd93/a</li>
<li><strong>Kauri original author:</strong> Onuwa Nnachi Isaac (@iamonuwa)</li>
<li><strong>Kauri original Publication date:</strong> 2019-08-29</li>
<li><strong>Kauri original tags:</strong> smart-contract, testing, vyper</li>
<li><strong>Kauri original hash:</strong> QmX6Cjg1tiFC6RcCrXGodStwSP2t6CsjmYPA2FxvMRYBLo</li>
<li><strong>Kauri original checkpoint:</strong> QmUP9qZg9vxiTYmDyCRfVzpyYLQbtd6r3GAM7CyqCFhShv</li>
</ul></div>
                <footer>
    <div class="footer-buttons">
        <div class="previous"><a href="../truffle--smart-contract-compilation-and-deploymen/" title="Truffle Smart Contract Compilation & Deployment"><span>Previous</span></a></div>
        <div class="next"><a href="../tools-for-working-with-vyper/" title="Tools for working with Vyper"><span>Next</span></a></div>
    </div>
    <div class="footer-note">
        <p>
            Built with <a href="http://www.mkdocs.org">MkDocs</a> using
            <a href="https://github.com/daizutabi/mkdocs-ivory">Ivory theme</a>.
        </p>
    </div>
</footer>
            </div>
        </main>
    </div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js"></script>
    <script src="../../../search/main.js"></script>
</body>

</html>